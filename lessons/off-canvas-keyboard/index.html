<!DOCTYPE html>
<html lang="en" class="no-js">

<!-- /off-canvas-keyboard/  Mon, 24 Jan 2022 10:05:07 GMT -->
<!-- OpenDir --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /OpenDir -->
<head>
    <meta charset="UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>

<title>üõ†Ô∏è Off-canvas: Adding keyboard interaction | Learn JavaScript</title>
<meta name="description" content="Learn JavaScript student portal"/>
<link rel="canonical" href="index.html">


<!-- Favicons -->
<link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
<link rel="manifest" href="../../favicons/site.webmanifest">
<link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#ffc40d">
<meta name="msapplication-config" content="../../favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- CSS -->
<link rel="stylesheet" href="../../css/styles-min-afc4baccb2.css">

<!-- Fonts -->
<script>
  (function (d) {
    var config = {
        kitId: 'gas0cwl',
        scriptTimeout: 3000,
        async: true
      },
      h = d.documentElement,
      t = setTimeout(function () {
        h.className = h
          .className
          .replace(/\bwf-loading\b/g, "") + " wf-inactive";
      }, config.scriptTimeout),
      tk = d.createElement("script"),
      f = false,
      s = d.getElementsByTagName("script")[0],
      a;
    h.className += " wf-loading";
    tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
    tk.async = true;
    tk.onload = tk.onreadystatechange = function () {
      a = this.readyState;
      if (f || a && a != "complete" && a != "loaded")
        return;
      f = true;
      clearTimeout(t);
      try {
        Typekit.load(config)
      } catch (e) {}
    };
    s
      .parentNode
      .insertBefore(tk, s)
  })(document);
</script>

<script>
  document
    .documentElement
    .classList
    .remove('no-js')
</script>

</head>

  <body class="page">
      <nav class="main-nav" data-js="menu" data-state="closed">
        <div>
          <a href="../index.html"><svg
  class="logo"
  data-size="small"
  height="1em"
  viewbox="0 0 273 43"
  xmlns="http://www.w3.org/2000/svg"
>
  <g transform="translate(-1 -10)" fill="none" fill-rule="evenodd">
    <rect fill="#F8E201" x="31" y="11" width="217" height="42" />
    <path
      d="M5.21 44.261v-5.217c0-2.726-.706-4.418-3.902-5.076v-3.76c3.196-.705 3.901-2.209 3.901-4.841v-6.11c0-4.606 2.68-8.178 8.695-8.178h1.551v3.995c-3.948 0-5.546 1.645-5.546 5.264v4.23c0 3.196-.94 6.345-4.136 7.473 3.102 1.175 4.136 4.042 4.136 7.05v4.089c0 4.183 1.598 5.828 5.546 5.828v3.995h-1.55c-5.782 0-8.696-3.243-8.696-8.742zm263.967-5.217l.141 5.217c-.141 5.499-2.961 8.742-8.789 8.742h-1.551v-3.995c3.948 0 5.499-1.645 5.499-5.828v-4.089c0-3.008 1.081-5.875 4.183-7.05-3.196-1.128-4.183-4.277-4.183-7.473v-4.23c0-3.619-1.551-5.264-5.499-5.264v-3.995h1.551c5.969 0 8.648 3.572 8.648 8.178v6.11c0 2.632.705 4.136 3.901 4.841v3.76c-3.196.658-3.901 2.35-3.901 5.076z"
      fill="#000"
      fill-rule="nonzero"
    />
    <path
      d="M29.82 52V11.5h7.74v34.56h17.46V52h-25.2zM58.2 37.78c0-8.16 3.54-16.32 13.68-16.32 8.4 0 12.18 5.1 12.18 13.62 0 .96-.06 1.92-.12 3H65.76c.06 7.44 3 9.36 6.54 9.36 2.76 0 5.52-1.2 5.52-4.2 0-.24-.06-.48-.06-.78l6 .84c.06.3.06.66.06 1.02 0 5.4-5.28 8.4-11.76 8.4-8.04 0-13.86-4.62-13.86-14.94zm13.62-11.7c-2.76 0-5.04 2.04-5.82 7.5h10.56v-1.02c0-3.48-1.38-6.48-4.74-6.48zM88.2 44.26c0-6.36 6.06-9.54 12.42-9.54 2.64 0 4.02.6 4.62.96v-4.32c0-3.42-1.32-5.1-4.44-5.1-3.66 0-4.8 2.4-3.96 5.7l-7.02-.78c-1.56-6.84 4.2-9.72 11.4-9.72 7.98 0 11.34 3.48 11.34 9.9v13.26c0 1.38.36 2.04 1.2 2.04 1.08 0 1.92-.96 1.92-.96l.42 5.22s-2.04 1.5-4.92 1.5c-2.94 0-4.98-1.5-5.46-4.62-1.56 2.94-4.56 4.92-8.46 4.92-5.16 0-9.06-3.48-9.06-8.46zm11.28 3.18c2.46 0 4.26-1.38 5.76-3.06v-5.16c-.6 0-1.38-.06-2.34-.06-4.8 0-7.44 1.44-7.44 4.62 0 2.46 1.62 3.66 4.02 3.66zM120.96 52V22.18h5.58l1.02 5.52c1.2-3.18 3.6-6.24 8.1-6.24 6.24 0 7.62 6.66 5.7 11.28l-6.3.84c.84-2.4.96-6-2.04-6-2.64 0-3.96 2.46-4.68 4.56V52h-7.38zm25.86 0V22.18h5.58l.9 4.86c2.22-3.24 4.68-5.58 9.36-5.58 5.04 0 8.88 2.82 8.88 9.18V52h-7.38V32.08c0-3.24-1.2-4.68-3.96-4.68-2.64 0-4.44 1.26-6 2.88V52h-7.38zm47.46-34.86V11.5h17.46v28.8c0 7.5-4.2 12.42-12.18 12.42-8.52 0-13.14-5.52-10.98-13.5l6.84-.72c-1.26 5.16-.06 8.4 3.96 8.4 3.06 0 4.62-1.92 4.62-5.58V17.14h-9.72zm23.94 22.62l6.9-.72c-1.08 4.26 1.2 7.98 8.1 7.98 5.46 0 7.2-2.4 7.2-5.16 0-3.66-3.3-5.04-8.04-6.66-5.76-1.98-13.44-4.38-13.44-12.84 0-7.2 5.52-11.7 14.88-11.58 11.04.12 14.94 6.42 13.74 13.32l-7.32.72c.78-5.76-1.56-8.46-6.96-8.46-4.56 0-6.54 2.04-6.54 5.04 0 4.02 3.72 5.34 8.4 6.9 6.06 1.98 13.02 4.32 13.02 12.36 0 6.84-5.1 12.06-15.24 12.06-9.48 0-16.08-4.5-14.7-12.96z"
      fill="#000"
      fill-rule="nonzero"
    />
  </g>
</svg>
</a>
          <button data-type="secondary" data-js="menu-button">Menu</button>
        </div>
        <div>
          <a href="../index.html">Contents</a>
          <a href="../../components/index.html">Components</a>
          <a href="../../community/index.html">Community</a>
          <a href="../../extras/index.html">Extras</a>
        </div>
        <div>
          <a href="../..https://nerd-dir.com">Account</a>
          <button data-type="secondary" data-js="logout">OpenDir</button>
        </div>
      </nav>

    <noscript>
      <div class="wrap">
        This portal uses JavaScript to check your identity. Please enable JavaScript to access the course.
      </div>
    </noscript>

    <main>
      <div class="wrap">
<div
  data-js="check-auth"
  data-required-authorization="mastery"
  data-auth-state="failure"
>
  <article class="longform" data-failed-content>
    <h1>üõ†Ô∏è Off-canvas: Adding keyboard interaction</h1>
    <p>Hey <span data-js="user-data" data-field="firstName">,</p>
      <p>
      I'm thrilled to help you learn JavaScript. Unfortunately, you've landed on a page where you cannot access with your current purchase.
    </p>
      <p>
      Please upgrade (<a href="../../404/index.html" data-upgrade-link
        >use this link</a
      >) access this content.
    </p>

      <p>I'm super eager to help you learn more!</p>
    </article>

    <article class="longform" data-content>
      <h1>üõ†Ô∏è Off-canvas: Adding keyboard interaction</h1>



      <div class="meta source-code">


    <a href="../../download/components/off-canvas-menu/04.keyboard.zip">
      <svg class="icon" viewBox="0 0 20 20" height="1em">
        <path fill="currentColor" d="M.7 9.3l4.8-4.8 1.4 1.42L2.84 10l4.07 4.07-1.41 1.42L0 10l.7-.7zm18.6 1.4l.7-.7-5.49-5.49-1.4 1.42L17.16 10l-4.07 4.07 1.41 1.42 4.78-4.78z"/>
      </svg>
      <span>Source</span>
    </a>
      </div><p>In this lesson, you will learn to:</p>
<ol>
<li>Open the off-canvas menu with the keyboard</li>
<li>Close the off-canvas menu with the keyboard</li>
</ol>
<p>Before you do anything, add this code to normalize the differences between browser clicks on buttons elements.</p>
<pre><code class="language-js">document.addEventListener('click', event =&gt; {
  if (event.target.matches('button')) {
    event.target.focus()
  }
})
</code></pre>
<h2 id="opening-the-off-canvas-menu">Opening the off-canvas menu</h2>
<p>You don‚Äôt have to write any extra code to open the menu. You can open it already.</p>
<p>To open the menu, hit <code>Tab</code> until you focus on the button. Then, hit <code>Space</code> or <code>Enter</code> to open the menu. This works because both <code>Space</code> and <code>Enter</code> trigger a <code>click</code> event on a button.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/open.gif" alt="Opens the Off-canvas menu with the keyboard"></figure>
<h2 id="directing-focus-to-the-menu">Directing focus to the menu</h2>
<p>When a user opens the off-canvas menu with a keyboard, they expect to Tab to focus on a menu item.</p>
<p>Right now, if you press <code>Tab</code> after opening the menu, focus does not go into the menu. Instead, it goes to the first Tab you opened in the browser if you‚Äôre using Chrome. (If you use Safari, focus goes to the browser‚Äôs back button)</p>
<p>This happens because <code>&lt;button&gt;</code> is the last focusable element on the page. If there was another focusable element after <code>&lt;button&gt;</code>, Tab would focus that element instead.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/next-tab.gif" alt="Next Tab goes to the first opened tab on Chrome."></figure>
<p>We want to direct focus to the off-canvas menu so users can Tab into a menu item.</p>
<p>To do this, we add <code>tabindex=&quot;-1&quot;</code> to the menu. This makes the menu focusable with JavaScript.</p>
<pre><code class="language-html">&lt;div class=&quot;offsite-container&quot;&gt;
  &lt;nav class=&quot;nav&quot; tabindex=&quot;-1&quot;&gt;
    &lt;!-- ... --&gt;
  &lt;/nav&gt;
&lt;/div&gt;
</code></pre>
<p>Now, we can direct focus to the menu when it opens.</p>
<pre><code class="language-js">const menu = document.querySelector('.nav')

button.addEventListener('click', event =&gt; {
  body.classList.toggle('offsite-is-open')
  if (body.classList.contains('offsite-is-open')) {
    menu.focus()
  }
})
</code></pre>
<p>Here‚Äôs how to read the code:</p>
<ol>
<li>If <code>&lt;body&gt;</code> contains <code>offsite-is-open</code> class, we remove the class. Otherwise, we add the class.</li>
<li>After we add or remove the <code>offsite-is-open</code> class, we check whether <code>&lt;body&gt;</code> contains <code>offsite-is-open</code> again. If <code>&lt;body&gt;</code> contains the class, we focus on <code>menu</code>.</li>
</ol>
<p>This can be confusing because we changed the DOM with <code>classList.toggle</code>. We can make the code straightforward by NOT using <code>classList.toggle</code>.</p>
<pre><code class="language-js">button.addEventListener('click', event =&gt; {
  if (body.classList.contains('offsite-is-open')) {
    body.classList.remove('offsite-is-open')
  } else {
    body.classList.add('offsite-is-open')
    menu.focus()
  }
})
</code></pre>
<p>If you open the menu now, you‚Äôll see this:</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/focus.gif" alt="Shifts focus to offsite container."></figure>
<p>There‚Äôs a blue focus ring around <code>.nav</code> because we focused on <code>.nav</code>. But we should not show the blue focus ring because users cannot interact with <code>.nav</code>. We need to hide the blue focus ring.</p>
<p>To do so, we set <code>outline</code> to <code>none</code>. I‚Äôm going to add this code to the <code>reset.css</code> file for all components going forward.</p>
<pre><code class="language-css">[tabindex=&quot;-1&quot;] {
  outline: none !important;
}
</code></pre>
<p>Now, if you open the off-canvas menu, you won‚Äôt see the blue focus ring. When you hit Tab, you focus on the first menu item.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/focus-done.gif" alt="Removed focus from offsiteContainer."></figure>
<h2 id="closing-the-off-canvas-menu">Closing the off-canvas menu</h2>
<p>You can close the menu if you navigate to the <code>&lt;button&gt;</code> and hit Space or Enter.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/close-focus.gif" alt="Tabs until the button gets focus, then closes the menu with space."></figure>
<p>But this is too tedious. Nobody would Tab to the <code>&lt;button&gt;</code> element to close the off-canvas menu. We want to provide a way for users to close the menu easily.</p>
<p>One way is to let users close the menu by pressing the Escape key. We can do this by listening to a <code>keydown</code> event.</p>
<pre><code class="language-js">document.addEventListener('keydown', event =&gt; {
  if (event.key === 'Escape' &amp;&amp; body.classList.contains('offsite-is-open')) {
    body.classList.remove('offsite-is-open')
  }
})
</code></pre>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/escape.gif" alt="Closes the menu with the escape key."></figure>
<p>When we close the off-canvas menu, we want to return focus back to <code>&lt;button&gt;</code>. This allows users to continue navigating to the rest of the page with <code>Tab</code>.</p>
<pre><code class="language-js">document.addEventListener('keydown', event =&gt; {
  if (event.key === 'Escape' &amp;&amp; body.classList.contains('offsite-is-open')) {
    body.classList.remove('offsite-is-open')
    button.focus()
  }
})
</code></pre>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/escape-focus.gif" alt="Closes the menu with the escape key."></figure>
<h2 id="quick-cleanup">Quick cleanup</h2>
<p>Did you notice we checked for <code>.offsite-is-open</code> twice? Did you also notice we closed the off-canvas menu by removing <code>.offsite-is-open</code> twice?</p>
<p>We can clean up the code by creating two functions here:</p>
<ol>
<li>A function to check whether the sidebar is opened</li>
<li>A function to close the sidebar</li>
</ol>
<pre><code class="language-js">// Checks whether the sidebar is open
const isOffcanvasMenuOpen = _ =&gt; {
  return body.classList.contains('offsite-is-open')
}
</code></pre>
<pre><code class="language-js">// Closes sidebar
const closeOffcanvasMenu = _ =&gt; {
  body.classList.remove('offsite-is-open')
  button.focus()
}
</code></pre>
<p>Since we have a function that closes the sidebar, let‚Äôs make a function that opens the sidebar as well.</p>
<pre><code class="language-js">// Opens sidebar
const openOffcanvasMenu = _ =&gt; {
  body.classList.add('offsite-is-open')
  menu.focus()
}
</code></pre>
<p>We can use the three new functions like this:</p>
<pre><code class="language-js">// In the click event
button.addEventListener('click', event =&gt; {
  isOffcanvasMenuOpen()
    ? closeOffcanvasMenu()
    : openOffcanvasMenu()
})
</code></pre>
<pre><code class="language-js">// In the keydown event
document.addEventListener('keydown', event =&gt; {
  if (isOffcanvasMenuOpen() &amp;&amp; event.key === 'Escape') {
    closeOffcanvasMenu()
  }
})
</code></pre>
<h2 id="prevent-tab-access-for-hidden-elements">Prevent Tab access for hidden elements</h2>
<p>Try hitting Tab right after you refresh the page. You will be able to Tab into items inside the off-canvas menu, even when the off-canvas menu is closed.</p>
<p>This is a mistake many developers make with their menu.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/closed-menu-focus-ring.gif" alt="Users can tab into the off-canvas menu when it's  closed."></figure>
<p>If users cannot interact with an element, they should not be able to focus on it. To prevent users from interacting with inaccessible elements, we can set <code>visibility</code> to <code>hidden</code>.</p>
<p>When we show the off-canvas menu, we need to set <code>visibility</code> back to <code>visible</code>.</p>
<pre><code class="language-css">.offsite-container {
  visibility: hidden;
}

.offsite-is-open.offsite-container {
  visibility: visible;
}
</code></pre>
<p>Now, users would not be able to Tab into the menu when it‚Äôs hidden.</p>
<figure role="figure"><img src="../../images/components/off-canvas/keyboard/prevent-inaccessible-focus.gif" alt="Prevented users from focusing on the hidden menu."></figure>
<p>Unfortunately, we broke the menu‚Äôs transition when we added the <code>visibility</code> property. (The sidebar closes abruptly).</p>
<video autoplay loop>
  <source src="../../images/components/off-canvas/keyboard/transition-problem.mp4" type="video/mp4">
  Your browser doesn't support embedded videos. Watch the video <a href="../../images/components/off-canvas/keyboard/transition-problem.mp4"> here </a> instead.
</video>
<p>We can fix this by adding a <code>transition-delay</code> for visibility.</p>
<pre><code class="language-css">.offsite-container {
  transition: transform 0.3s ease-out, visibility 0.3s;
  visibility: hidden;
}

.offsite-is-open .offsite-container {
  transition-delay: visibility 0.3s;
  visibility: visible;
}
</code></pre>
<video autoplay loop>
  <source src="../../images/components/off-canvas/keyboard/transition-fixed.mp4" type="video/mp4">
  Your browser doesn't support embedded videos. Watch the video <a href="../../images/components/off-canvas/keyboard/transition-fixed.mp4"> here </a> instead.
</video>
<p>That‚Äôs it!</p>
</article>
  </div>



  <div class="longform">
    <nav class="lesson-nav">

          <a href="../single-key-shortcuts/index.html" data-link-to="previous-lesson">
              <svg height="1em" viewbox="0 0 22 38">
                <path
          fill="currentColor"
          d="M18.9 38l3.1-3.1L6.1 19 22 3.1 18.9 0 0 19z"
        ></path>
              </svg>
              <span>Creating single-key shortcuts</span>
            </a>
          <a href="../modal-keyboard/index.html" data-link-to="next-lesson">
              <span>üõ†Ô∏è Modal: Adding keyboard interaction</span>
              <svg height="1em" viewbox="0 0 22 38">
                <path
          fill="currentColor"
          d="M3.1 0L0 3.1 15.9 19 0 34.9 3.1 38 22 19z"
        ></path>
              </svg>
            </a>
          </nav>
  </div>
</div>
    </main>



      <script module src="../../js/main-b9439821d7.mjs"></script>
      <script nomodule src="../../js/main-legacy-8c54230a8f.js"></script>
  </body>

<!-- /off-canvas-keyboard/  Mon, 24 Jan 2022 10:05:09 GMT -->
</html>
