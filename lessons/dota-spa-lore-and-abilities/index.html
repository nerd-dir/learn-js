<!DOCTYPE html>
<html lang="en" class="no-js">

<!-- /dota-spa-lore-and-abilities/  Mon, 24 Jan 2022 10:08:12 GMT -->
<!-- OpenDir --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /OpenDir -->
<head>
    <meta charset="UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>

<title>üõ†Ô∏è Dota SPA: Lore and abilities | Learn JavaScript</title>
<meta name="description" content="Learn JavaScript student portal"/>
<link rel="canonical" href="index.html">


<!-- Favicons -->
<link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
<link rel="manifest" href="../../favicons/site.webmanifest">
<link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#ffc40d">
<meta name="msapplication-config" content="../../favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- CSS -->
<link rel="stylesheet" href="../../css/styles-min-afc4baccb2.css">

<!-- Fonts -->
<script>
  (function (d) {
    var config = {
        kitId: 'gas0cwl',
        scriptTimeout: 3000,
        async: true
      },
      h = d.documentElement,
      t = setTimeout(function () {
        h.className = h
          .className
          .replace(/\bwf-loading\b/g, "") + " wf-inactive";
      }, config.scriptTimeout),
      tk = d.createElement("script"),
      f = false,
      s = d.getElementsByTagName("script")[0],
      a;
    h.className += " wf-loading";
    tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
    tk.async = true;
    tk.onload = tk.onreadystatechange = function () {
      a = this.readyState;
      if (f || a && a != "complete" && a != "loaded")
        return;
      f = true;
      clearTimeout(t);
      try {
        Typekit.load(config)
      } catch (e) {}
    };
    s
      .parentNode
      .insertBefore(tk, s)
  })(document);
</script>

<script>
  document
    .documentElement
    .classList
    .remove('no-js')
</script>

</head>

  <body class="page">
      <nav class="main-nav" data-js="menu" data-state="closed">
        <div>
          <a href="../index.html"><svg
  class="logo"
  data-size="small"
  height="1em"
  viewbox="0 0 273 43"
  xmlns="http://www.w3.org/2000/svg"
>
  <g transform="translate(-1 -10)" fill="none" fill-rule="evenodd">
    <rect fill="#F8E201" x="31" y="11" width="217" height="42" />
    <path
      d="M5.21 44.261v-5.217c0-2.726-.706-4.418-3.902-5.076v-3.76c3.196-.705 3.901-2.209 3.901-4.841v-6.11c0-4.606 2.68-8.178 8.695-8.178h1.551v3.995c-3.948 0-5.546 1.645-5.546 5.264v4.23c0 3.196-.94 6.345-4.136 7.473 3.102 1.175 4.136 4.042 4.136 7.05v4.089c0 4.183 1.598 5.828 5.546 5.828v3.995h-1.55c-5.782 0-8.696-3.243-8.696-8.742zm263.967-5.217l.141 5.217c-.141 5.499-2.961 8.742-8.789 8.742h-1.551v-3.995c3.948 0 5.499-1.645 5.499-5.828v-4.089c0-3.008 1.081-5.875 4.183-7.05-3.196-1.128-4.183-4.277-4.183-7.473v-4.23c0-3.619-1.551-5.264-5.499-5.264v-3.995h1.551c5.969 0 8.648 3.572 8.648 8.178v6.11c0 2.632.705 4.136 3.901 4.841v3.76c-3.196.658-3.901 2.35-3.901 5.076z"
      fill="#000"
      fill-rule="nonzero"
    />
    <path
      d="M29.82 52V11.5h7.74v34.56h17.46V52h-25.2zM58.2 37.78c0-8.16 3.54-16.32 13.68-16.32 8.4 0 12.18 5.1 12.18 13.62 0 .96-.06 1.92-.12 3H65.76c.06 7.44 3 9.36 6.54 9.36 2.76 0 5.52-1.2 5.52-4.2 0-.24-.06-.48-.06-.78l6 .84c.06.3.06.66.06 1.02 0 5.4-5.28 8.4-11.76 8.4-8.04 0-13.86-4.62-13.86-14.94zm13.62-11.7c-2.76 0-5.04 2.04-5.82 7.5h10.56v-1.02c0-3.48-1.38-6.48-4.74-6.48zM88.2 44.26c0-6.36 6.06-9.54 12.42-9.54 2.64 0 4.02.6 4.62.96v-4.32c0-3.42-1.32-5.1-4.44-5.1-3.66 0-4.8 2.4-3.96 5.7l-7.02-.78c-1.56-6.84 4.2-9.72 11.4-9.72 7.98 0 11.34 3.48 11.34 9.9v13.26c0 1.38.36 2.04 1.2 2.04 1.08 0 1.92-.96 1.92-.96l.42 5.22s-2.04 1.5-4.92 1.5c-2.94 0-4.98-1.5-5.46-4.62-1.56 2.94-4.56 4.92-8.46 4.92-5.16 0-9.06-3.48-9.06-8.46zm11.28 3.18c2.46 0 4.26-1.38 5.76-3.06v-5.16c-.6 0-1.38-.06-2.34-.06-4.8 0-7.44 1.44-7.44 4.62 0 2.46 1.62 3.66 4.02 3.66zM120.96 52V22.18h5.58l1.02 5.52c1.2-3.18 3.6-6.24 8.1-6.24 6.24 0 7.62 6.66 5.7 11.28l-6.3.84c.84-2.4.96-6-2.04-6-2.64 0-3.96 2.46-4.68 4.56V52h-7.38zm25.86 0V22.18h5.58l.9 4.86c2.22-3.24 4.68-5.58 9.36-5.58 5.04 0 8.88 2.82 8.88 9.18V52h-7.38V32.08c0-3.24-1.2-4.68-3.96-4.68-2.64 0-4.44 1.26-6 2.88V52h-7.38zm47.46-34.86V11.5h17.46v28.8c0 7.5-4.2 12.42-12.18 12.42-8.52 0-13.14-5.52-10.98-13.5l6.84-.72c-1.26 5.16-.06 8.4 3.96 8.4 3.06 0 4.62-1.92 4.62-5.58V17.14h-9.72zm23.94 22.62l6.9-.72c-1.08 4.26 1.2 7.98 8.1 7.98 5.46 0 7.2-2.4 7.2-5.16 0-3.66-3.3-5.04-8.04-6.66-5.76-1.98-13.44-4.38-13.44-12.84 0-7.2 5.52-11.7 14.88-11.58 11.04.12 14.94 6.42 13.74 13.32l-7.32.72c.78-5.76-1.56-8.46-6.96-8.46-4.56 0-6.54 2.04-6.54 5.04 0 4.02 3.72 5.34 8.4 6.9 6.06 1.98 13.02 4.32 13.02 12.36 0 6.84-5.1 12.06-15.24 12.06-9.48 0-16.08-4.5-14.7-12.96z"
      fill="#000"
      fill-rule="nonzero"
    />
  </g>
</svg>
</a>
          <button data-type="secondary" data-js="menu-button">Menu</button>
        </div>
        <div>
          <a href="../index.html">Contents</a>
          <a href="../../components/index.html">Components</a>
          <a href="../../community/index.html">Community</a>
          <a href="../../extras/index.html">Extras</a>
        </div>
        <div>
          <a href="../..https://nerd-dir.com">Account</a>
          <button data-type="secondary" data-js="logout">OpenDir</button>
        </div>
      </nav>

    <noscript>
      <div class="wrap">
        This portal uses JavaScript to check your identity. Please enable JavaScript to access the course.
      </div>
    </noscript>

    <main>
      <div class="wrap">
<div
  data-js="check-auth"
  data-required-authorization="mastery"
  data-auth-state="failure"
>
  <article class="longform" data-failed-content>
    <h1>üõ†Ô∏è Dota SPA: Lore and abilities</h1>
    <p>Hey <span data-js="user-data" data-field="firstName">,</p>
      <p>
      I'm thrilled to help you learn JavaScript. Unfortunately, you've landed on a page where you cannot access with your current purchase.
    </p>
      <p>
      Please upgrade (<a href="../../404/index.html" data-upgrade-link
        >use this link</a
      >) access this content.
    </p>

      <p>I'm super eager to help you learn more!</p>
    </article>

    <article class="longform" data-content>
      <h1>üõ†Ô∏è Dota SPA: Lore and abilities</h1>



      <div class="meta source-code">


    <a href="../../download/components/dota-spa/08.hero-page-complete.zip">
      <svg class="icon" viewBox="0 0 20 20" height="1em">
        <path fill="currentColor" d="M.7 9.3l4.8-4.8 1.4 1.42L2.84 10l4.07 4.07-1.41 1.42L0 10l.7-.7zm18.6 1.4l.7-.7-5.49-5.49-1.4 1.42L17.16 10l-4.07 4.07 1.41 1.42 4.78-4.78z"/>
      </svg>
      <span>Source</span>
    </a>
      </div><p>To render lore and abilities, we need to fetch three more pieces of data from the Dota API. For code simplicity, we can put all these three requests into a single <code>Promise.all</code> call.</p>
<pre><code class="language-javascript">// HeroPage.js
export default Tiny({
  async afterMount () {
    const dotaApi = 'https://api.opendota.com/api'
    const responses = await Promise.all([
      zlFetch(`${dotaApi}/constants/hero_lore`),
      zlFetch(`${dotaApi}/constants/abilities`),
      zlFetch(`${dotaApi}/constants/hero_abilities`)
    ])
  }
})
</code></pre>
<p>When the data is fetched, we put this data into the <code>state</code>. We can use the data once they‚Äôre in <code>state</code>.</p>
<pre><code class="language-javascript">export default Tiny({
  async afterMount () {
    // ...
    this.setState({
      lores: responses[0].body,
      dotaAbilities: responses[1].body,
      heroAbilities: responses[2].body
    })
  }
})
</code></pre>
<h2 id="rending-the-hero%E2%80%99s-description">Rending the hero‚Äôs description</h2>
<p>To render the hero description, we need to pass the <code>npcName</code> into the lores.</p>
<pre><code class="language-javascript">export default Tiny({
  heroHTML () {
    // ...
    return `&lt;div class=&quot;single-column flow-2&quot;&gt;
      &lt;div class=&quot;clear site-title&quot;&gt;
        &lt;h1 data-hero-name&gt;${hero.name}&lt;/h1&gt;
        &lt;img
          class=&quot;hero__img&quot;
          data-hero-image
          src=&quot;${hero.image}&quot;
        /&gt;
        &lt;p data-hero-description&gt;${this.state.lores[npcName]}&lt;/p&gt;
      &lt;/div&gt;`
  }
})
</code></pre>
<p>This doesn‚Äôt work immediately. You‚Äôll get an error like this:</p>
<figure role="figure">
  <img src="../../images/components/dota-spa/hero-page-2/error.png" alt="" loading="lazy">
</figure>
<p>This error happens because lores is not defined yet. We cannot get the <code>npcHeroName</code> from an <code>undefined</code> object.</p>
<p>So the best way is to check whether <code>state.lores</code> is defined before rendering it. We can do this with a <code>getHeroDescription</code> function.</p>
<pre><code class="language-javascript">export default Tiny({
  // ...
  getHeroDescription (npcName) {
    if (!this.state.lores) return ''
    return this.state.lores[npcName]
  }
  // ...
}
</code></pre>
<p>Using it:</p>
<pre><code class="language-javascript">export default Tiny({
  heroHTML () {
    // ...
    return `&lt;div class=&quot;single-column flow-2&quot;&gt;
      &lt;div class=&quot;clear site-title&quot;&gt;
        &lt;h1 data-hero-name&gt;${hero.name}&lt;/h1&gt;
        &lt;img
          class=&quot;hero__img&quot;
          data-hero-image
          src=&quot;${hero.image}&quot;
        /&gt;
        &lt;p data-hero-description&gt;${this.getHeroDescription(npcName)}&lt;/p&gt;
      &lt;/div&gt;`
  }
})
</code></pre>
<figure role="figure">
  <img src="../../images/components/dota-spa/hero-page-2/lore.png" alt="" loading="lazy">
</figure>
<h2 id="rendering-the-hero%E2%80%99s-abilities">Rendering the hero‚Äôs abilities</h2>
<p>Let‚Äôs create a function called <code>getHeroAbilities</code> to retrieve the hero‚Äôs abilities.</p>
<pre><code class="language-javascript">export default function Tiny ({
  // ...
  getHeroAbilities () {

  },
  // ...
})
</code></pre>
<p>Here‚Äôs the code we wrote in the Asynchronous JavaScript Module. `</p>
<pre><code class="language-javascript">Promise.all([
  zlFetch(`${dotaApi}/constants/abilities`),
  zlFetch(`${dotaApi}/constants/hero_abilities`)
]).then(responses =&gt; {
  const allAbilities = responses[0].body
  const heroAbilities = responses[1].body

  const axeAbilities = heroAbilities[`npc_dota_hero_${heroName}`].abilities
    .filter(ability =&gt; ability !== 'generic_hidden')
    .map(ability =&gt; allAbilities[ability])
    .map(ability =&gt; {
      return {
        name: ability.dname,
        description: ability.desc,
        image: `https://api.opendota.com${ability.img}`
      }
    })
    .map(ability =&gt; {
      return `&lt;li class=&quot;ability&quot;&gt;
          &lt;p class=&quot;ability__title&quot;&gt;${ability.name}&lt;/p&gt;
          &lt;img class=&quot;ability__img&quot; src=&quot;${ability.image}&quot; alt=&quot;${ability.name}&quot;&gt;
          &lt;p class=&quot;desc&quot;&gt;${ability.description}&lt;/p&gt;
        &lt;/li&gt;`
    })
    .join('')

  heroAbilitiesEl.innerHTML = axeAbilities
  heroAbilitiesEl.closest('section').removeAttribute('hidden')
})
</code></pre>
<p>This code is broken down into three parts.</p>
<ul>
<li>For getting information about abilities from Dota API</li>
<li>For creating an array of the hero‚Äôs abilities</li>
<li>For creating the HTML for the hero‚Äôs abilities</li>
</ul>
<p>We can reuse most of this code. In this case, we already have ability data stored inside <code>state</code>.</p>
<ul>
<li><code>allAbilities</code> is stored in <code>state.dotaAbilities</code> (I changed the variable name because I felt <code>dotaAbilities</code> explained what it holds better than <code>allAbilities</code>)</li>
<li><code>heroAbilities</code> is stored in <code>state.heroAbilities</code>.</li>
</ul>
<p>We only need the second part in <code>getHeroAbilities</code>. So we can copy-paste that part in.</p>
<p>Make sure to change the following variables so we use the code we have now:</p>
<ul>
<li><code>heroName</code> to <code>npcName</code></li>
<li><code>allAbilities</code> to <code>heroAbilities</code></li>
</ul>
<pre><code class="language-javascript">export default function Tiny ({
  getHeroAbilities (npcName) {
    const { dotaAbilities, heroAbilities } = this.state
    if (!dotaAbilities &amp;&amp; !heroAbilities) return []

    return heroAbilities[`npc_dota_hero_${npcName}`]
      .abilities
      .filter(ability =&gt; ability !== 'generic_hidden')
      .map(ability =&gt; dotaAbilities[ability])
      .map(ability =&gt; {
        return {
          name: ability.dname,
          description: ability.desc,
          image: `https://api.opendota.com${ability.img}`
        }
      })
  },
})
</code></pre>
<p>We can now create the HTML for the hero‚Äôs abilities:</p>
<pre><code class="language-javascript">export default function Tiny ({
  // ...
  heroHTML () {
    // ...

    return `&lt;div class=&quot;single-column flow-2&quot;&gt;
      &lt;!-- Hero name, image, lore --&gt;

      &lt;section hidden&gt;
        &lt;h2&gt;Abilities&lt;/h2&gt;
        &lt;ul class=&quot;abilities flow&quot; data-hero-abilities&gt;
          ${this.getHeroAbilities(npcName).map(ability =&gt; {
            return `&lt;li class=&quot;ability&quot;&gt;
              &lt;p class=&quot;ability__title&quot;&gt;${ability.name}&lt;/p&gt;
              &lt;img class=&quot;ability__img&quot; src=&quot;${ability.image}&quot; alt=&quot;${ability.name}&quot;&gt;
              &lt;p class=&quot;desc&quot;&gt;${ability.description}&lt;/p&gt;
            &lt;/li&gt;`
          }).join('')}
        &lt;/ul&gt;
      &lt;/section&gt;
    &lt;/div&gt;`
  }
  // ...
})
</code></pre>
<p>To display the abilities, we need to remove the <code>hidden</code> attribute.</p>
<pre><code class="language-javascript">export default function Tiny ({
  // ...
  heroHTML () {
    // ...

    return `&lt;div class=&quot;single-column flow-2&quot;&gt;
      &lt;!-- Hero name, image, lore --&gt;

      &lt;section&gt;
        &lt;!-- ... --&gt;
      &lt;/section&gt;
    &lt;/div&gt;`
  }
  // ...
})
</code></pre>
<figure role="figure">
  <img src="../../images/components/dota-spa/hero-page-2/abilities.png" alt="" loading="lazy">
</figure>
<h2 id="hiding-the-abilities-section-until-it-is-needed">Hiding the abilities section until it is needed</h2>
<p>Why did we have the <code>hidden</code> attribute on the <code>&lt;section&gt;</code> element? If you recall, we wanted to hide the abilities section until we get information from the Dota API. It‚Äôs weird when you see the abilities section without any abilities. That‚Äôs why we hid it.</p>
<p>To prevent the abilities section from showing prematurely, we can check whether any abilities are returned from <code>getHeroAbilities</code>. If no abilities are returned, we can keep this section hidden.</p>
<pre><code class="language-javascript">export default function Tiny ({
  // ...
  heroHTML () {
    // ...
    const abilities = this.getHeroAbilities(npcName)

    return `&lt;div class=&quot;single-column flow-2&quot;&gt;
      &lt;!-- Hero name, image, lore --&gt;


      &lt;section ${abilities.length &gt; 0 ? '' : 'hidden'}&gt;
        &lt;h2&gt;Abilities&lt;/h2&gt;
        &lt;ul class=&quot;abilities flow&quot; data-hero-abilities&gt;
          ${abilities.map(ability =&gt; {
            // ...
          }).join('')}
        &lt;/ul&gt;
      &lt;/section&gt;
    &lt;/div&gt;`
  },
  // ...
})
</code></pre>
</article>
  </div>



  <div class="longform">
    <nav class="lesson-nav">

          <a href="../dota-spa-hero-page/index.html" data-link-to="previous-lesson">
              <svg height="1em" viewbox="0 0 22 38">
                <path
          fill="currentColor"
          d="M18.9 38l3.1-3.1L6.1 19 22 3.1 18.9 0 0 19z"
        ></path>
              </svg>
              <span>üõ†Ô∏è Dota SPA: Building the hero page</span>
            </a>
          <a href="../dota-spa-routing/index.html" data-link-to="next-lesson">
              <span>üõ†Ô∏è Dota SPA: Routing for Single-page apps</span>
              <svg height="1em" viewbox="0 0 22 38">
                <path
          fill="currentColor"
          d="M3.1 0L0 3.1 15.9 19 0 34.9 3.1 38 22 19z"
        ></path>
              </svg>
            </a>
          </nav>
  </div>
</div>
    </main>



      <script module src="../../js/main-b9439821d7.mjs"></script>
      <script nomodule src="../../js/main-legacy-8c54230a8f.js"></script>
  </body>

<!-- /dota-spa-lore-and-abilities/  Mon, 24 Jan 2022 10:08:13 GMT -->
</html>
