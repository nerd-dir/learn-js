<!DOCTYPE html>
<html lang="en" class="no-js">

<!-- /paginated-responses-1/  Mon, 24 Jan 2022 10:08:17 GMT -->
<!-- OpenDir --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /OpenDir -->
<head>
    <meta charset="UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>

<title>Dealing with paginated responses (part 1) | Learn JavaScript</title>
<meta name="description" content="Learn JavaScript student portal"/>
<link rel="canonical" href="index.html">


<!-- Favicons -->
<link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
<link rel="manifest" href="../../favicons/site.webmanifest">
<link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../../favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#ffc40d">
<meta name="msapplication-config" content="../../favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- CSS -->
<link rel="stylesheet" href="../../css/styles-min-afc4baccb2.css">

<!-- Fonts -->
<script>
  (function (d) {
    var config = {
        kitId: 'gas0cwl',
        scriptTimeout: 3000,
        async: true
      },
      h = d.documentElement,
      t = setTimeout(function () {
        h.className = h
          .className
          .replace(/\bwf-loading\b/g, "") + " wf-inactive";
      }, config.scriptTimeout),
      tk = d.createElement("script"),
      f = false,
      s = d.getElementsByTagName("script")[0],
      a;
    h.className += " wf-loading";
    tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
    tk.async = true;
    tk.onload = tk.onreadystatechange = function () {
      a = this.readyState;
      if (f || a && a != "complete" && a != "loaded")
        return;
      f = true;
      clearTimeout(t);
      try {
        Typekit.load(config)
      } catch (e) {}
    };
    s
      .parentNode
      .insertBefore(tk, s)
  })(document);
</script>

<script>
  document
    .documentElement
    .classList
    .remove('no-js')
</script>

</head>

  <body class="page">
      <nav class="main-nav" data-js="menu" data-state="closed">
        <div>
          <a href="../index.html"><svg
  class="logo"
  data-size="small"
  height="1em"
  viewbox="0 0 273 43"
  xmlns="http://www.w3.org/2000/svg"
>
  <g transform="translate(-1 -10)" fill="none" fill-rule="evenodd">
    <rect fill="#F8E201" x="31" y="11" width="217" height="42" />
    <path
      d="M5.21 44.261v-5.217c0-2.726-.706-4.418-3.902-5.076v-3.76c3.196-.705 3.901-2.209 3.901-4.841v-6.11c0-4.606 2.68-8.178 8.695-8.178h1.551v3.995c-3.948 0-5.546 1.645-5.546 5.264v4.23c0 3.196-.94 6.345-4.136 7.473 3.102 1.175 4.136 4.042 4.136 7.05v4.089c0 4.183 1.598 5.828 5.546 5.828v3.995h-1.55c-5.782 0-8.696-3.243-8.696-8.742zm263.967-5.217l.141 5.217c-.141 5.499-2.961 8.742-8.789 8.742h-1.551v-3.995c3.948 0 5.499-1.645 5.499-5.828v-4.089c0-3.008 1.081-5.875 4.183-7.05-3.196-1.128-4.183-4.277-4.183-7.473v-4.23c0-3.619-1.551-5.264-5.499-5.264v-3.995h1.551c5.969 0 8.648 3.572 8.648 8.178v6.11c0 2.632.705 4.136 3.901 4.841v3.76c-3.196.658-3.901 2.35-3.901 5.076z"
      fill="#000"
      fill-rule="nonzero"
    />
    <path
      d="M29.82 52V11.5h7.74v34.56h17.46V52h-25.2zM58.2 37.78c0-8.16 3.54-16.32 13.68-16.32 8.4 0 12.18 5.1 12.18 13.62 0 .96-.06 1.92-.12 3H65.76c.06 7.44 3 9.36 6.54 9.36 2.76 0 5.52-1.2 5.52-4.2 0-.24-.06-.48-.06-.78l6 .84c.06.3.06.66.06 1.02 0 5.4-5.28 8.4-11.76 8.4-8.04 0-13.86-4.62-13.86-14.94zm13.62-11.7c-2.76 0-5.04 2.04-5.82 7.5h10.56v-1.02c0-3.48-1.38-6.48-4.74-6.48zM88.2 44.26c0-6.36 6.06-9.54 12.42-9.54 2.64 0 4.02.6 4.62.96v-4.32c0-3.42-1.32-5.1-4.44-5.1-3.66 0-4.8 2.4-3.96 5.7l-7.02-.78c-1.56-6.84 4.2-9.72 11.4-9.72 7.98 0 11.34 3.48 11.34 9.9v13.26c0 1.38.36 2.04 1.2 2.04 1.08 0 1.92-.96 1.92-.96l.42 5.22s-2.04 1.5-4.92 1.5c-2.94 0-4.98-1.5-5.46-4.62-1.56 2.94-4.56 4.92-8.46 4.92-5.16 0-9.06-3.48-9.06-8.46zm11.28 3.18c2.46 0 4.26-1.38 5.76-3.06v-5.16c-.6 0-1.38-.06-2.34-.06-4.8 0-7.44 1.44-7.44 4.62 0 2.46 1.62 3.66 4.02 3.66zM120.96 52V22.18h5.58l1.02 5.52c1.2-3.18 3.6-6.24 8.1-6.24 6.24 0 7.62 6.66 5.7 11.28l-6.3.84c.84-2.4.96-6-2.04-6-2.64 0-3.96 2.46-4.68 4.56V52h-7.38zm25.86 0V22.18h5.58l.9 4.86c2.22-3.24 4.68-5.58 9.36-5.58 5.04 0 8.88 2.82 8.88 9.18V52h-7.38V32.08c0-3.24-1.2-4.68-3.96-4.68-2.64 0-4.44 1.26-6 2.88V52h-7.38zm47.46-34.86V11.5h17.46v28.8c0 7.5-4.2 12.42-12.18 12.42-8.52 0-13.14-5.52-10.98-13.5l6.84-.72c-1.26 5.16-.06 8.4 3.96 8.4 3.06 0 4.62-1.92 4.62-5.58V17.14h-9.72zm23.94 22.62l6.9-.72c-1.08 4.26 1.2 7.98 8.1 7.98 5.46 0 7.2-2.4 7.2-5.16 0-3.66-3.3-5.04-8.04-6.66-5.76-1.98-13.44-4.38-13.44-12.84 0-7.2 5.52-11.7 14.88-11.58 11.04.12 14.94 6.42 13.74 13.32l-7.32.72c.78-5.76-1.56-8.46-6.96-8.46-4.56 0-6.54 2.04-6.54 5.04 0 4.02 3.72 5.34 8.4 6.9 6.06 1.98 13.02 4.32 13.02 12.36 0 6.84-5.1 12.06-15.24 12.06-9.48 0-16.08-4.5-14.7-12.96z"
      fill="#000"
      fill-rule="nonzero"
    />
  </g>
</svg>
</a>
          <button data-type="secondary" data-js="menu-button">Menu</button>
        </div>
        <div>
          <a href="../index.html">Contents</a>
          <a href="../../components/index.html">Components</a>
          <a href="../../community/index.html">Community</a>
          <a href="../../extras/index.html">Extras</a>
        </div>
        <div>
          <a href="../..https://nerd-dir.com">Account</a>
          <button data-type="secondary" data-js="logout">OpenDir</button>
        </div>
      </nav>

    <noscript>
      <div class="wrap">
        This portal uses JavaScript to check your identity. Please enable JavaScript to access the course.
      </div>
    </noscript>

    <main>
      <div class="wrap">
<div
  data-js="check-auth"
  data-required-authorization="mastery"
  data-auth-state="failure"
>
  <article class="longform" data-failed-content>
    <h1>Dealing with paginated responses (part 1)</h1>
    <p>Hey <span data-js="user-data" data-field="firstName">,</p>
      <p>
      I'm thrilled to help you learn JavaScript. Unfortunately, you've landed on a page where you cannot access with your current purchase.
    </p>
      <p>
      Please upgrade (<a href="../../404/index.html" data-upgrade-link
        >use this link</a
      >) access this content.
    </p>

      <p>I'm super eager to help you learn more!</p>
    </article>

    <article class="longform" data-content>
      <h1>Dealing with paginated responses (part 1)</h1>



      <div class="meta source-code">


      </div><p>When you request for a list of items, many APIs respond with an incomplete list. For example, GitHub sends you 30 repositories even if the user has more than 30 repositories.</p>
<p>If you want to fetch all repositories, you can do two things:</p>
<ol>
<li>Increase the number of items per request</li>
<li>Make more requests</li>
</ol>
<h2 id="increasing-the-number-of-items-per-request">Increasing the number of items per request</h2>
<p>APIs may let you change the number of items you get per request. For example, GitHub lets you get up to 100 items. To get 100 items, you change the <code>per_page</code> query parameter.</p>
<p>If the user has more than 100 repositories, GitHub will send you the first 100 repositories. If the user has less than 100 repositories, GitHub will send you every repository.</p>
<p>For this lesson, we’re going to fetch Sindre Sorhus’s repositories. Sindre creates a lot of open source projects and has over 900 repositories on GitHub.</p>
<pre><code class="language-js">fetch('https://api.github.com/users/sindresorhus/repos?per_page=100')
  .then(r =&gt; r.json())
  .then(repos =&gt; console.log(repos))
</code></pre>
<h2 id="making-more-requests">Making more requests</h2>
<p>APIs will tell you how to make more requests. This is usually found in the Pagination section of the API. Make sure to read it.</p>
<p>How you make more requests depends on the first response.</p>
<p>If your first response tells you the total number of pages, you can fetch the rest of the information at once. If the response doesn’t tell you the total number of pages, you need to fetch page by page.</p>
<p>You’ll learn how to fetch many pages at once in this lesson, and how to fetch page by page in the next lesson.</p>
<h2 id="fetching-many-pages-at-once">Fetching many pages at once</h2>
<p>Many APIs use a <code>Link</code> header to tell you the number of pages. GitHub is one example.</p>
<figure>
  <img src="../../images/ajax/paginated/github-link-header.png" alt="">
</figure>
<p>When you get a paginated response from GitHub, you’ll see the <code>Link</code> header in your dev tools.</p>
<pre><code class="language-js">fetch('https://api.github.com/users/sindresorhus/repos?per_page=100')
</code></pre>
<figure>
  <img src="../../images/ajax/paginated/devtools-link-header.png" alt="">
</figure>
<p>Your first step is to get this link header in JavaScript. We have already gone through how.</p>
<p>Here’s how you do it with XHR.</p>
<pre><code class="language-js">// Getting link header with XHR
request.addEventListener('load', e =&gt; {
  const linkHeader = request.getRequestHeader('link')
})
</code></pre>
<p>Here’s how you do it with Fetch.</p>
<pre><code class="language-js">fetch('some-url')
  .then(r =&gt; {
    const headers = Array.from(r.headers.entries())
      .reduce((accumulator, [header, value]) =&gt; {
        return Object.assign(accumulator, {
          [header]: value
        })
      }, {})

    return r.json()
      .then(body =&gt; ({ headers, body }))
  })
  .then(response =&gt; {
    const linkHeader = response.headers.link
  })
</code></pre>
<p>And here’s how you do it with zlFetch.</p>
<pre><code class="language-js">zlFetch('some-url')
  .then(response =&gt; {
    console.log(response.headers) // the headers
    console.log(response.body) // the body
  })
</code></pre>
<p>I’m going to show you how to use Fetch for the rest of the lesson. You can try this out with zlFetch later.</p>
<h2 id="parsing-the-link-header">Parsing the link header</h2>
<p>If you examine the link header carefully, you’ll see a pattern. There are two parts to this link header:</p>
<ol>
<li>The link to the next page</li>
<li>The link to the last page</li>
</ol>
<p>These two links are separated by a comma.</p>
<figure>
  <img src="../../images/ajax/paginated/link-header.gif" alt="GIF that shows that the link header has two parts">
  <figcaption aria-hidden>The link header has two parts</figcaption>
</figure>
<p>You can also see that links to the next page (and last page) share another pattern:</p>
<ol>
<li>Each link begins and ends with angled brackets</li>
<li>The <code>rel</code> tells us which page the link leads to</li>
</ol>
<figure>
  <img src="../../images/ajax/paginated/link-header-parts.gif" alt="GIF that shows that each part of the link header has two more parts—link and rel.">
  <figcaption aria-hidden>Each part of the link header has two more parts—link and rel.</figcaption>
</figure>
<p>The two patterns let us convert the link header into a JavaScript object that looks like this:</p>
<pre><code class="language-js">const parsedLinkHeader = {
  next: 'a link',
  last: 'another link'
}
</code></pre>
<p>To create this JavaScript object, we need to split the header into two parts. We can do this with the <code>split</code> method.</p>
<h3 id="split">Split</h3>
<p><code>split</code> lets you split a string into two or more parts. These parts will be stored as an array.</p>
<pre><code class="language-js">const array = string.split(separator, limit)
</code></pre>
<p><code>separator</code> is the character(s) you want to use to split the string. The character(s) used will be removed from all parts.</p>
<p><code>limit</code> lets you control the number of splits to make. You won’t use this much.</p>
<p>Here’s an example:</p>
<pre><code class="language-js">const string = 'My name is Zell'
const array = string.split(' ')

console.log(array)
// ['My', 'name', 'is', 'Zell']
</code></pre>
<h3 id="splitting-the-link-header">Splitting the link header</h3>
<p>We want to split the link header into two parts:</p>
<ol>
<li>The “next” part</li>
<li>The “last” part</li>
</ol>
<figure>
  <img src="../../images/ajax/paginated/link-header.gif" alt="GIF that shows that the link header has two parts">
  <figcaption aria-hidden>The link header has two parts</figcaption>
</figure>
<p>We can do this with <code>split</code>.</p>
<pre><code class="language-js">const parts = linkHeader.split(',')

console.log(parts)
// [
//   &lt;https://api.github.com/user/170270/repos?per_page=100&amp;page=2&gt;; rel=&quot;next&quot;,
//   &lt;https://api.github.com/user/170270/repos?per_page=100&amp;page=10&gt;; rel=&quot;last&quot;
// ]
</code></pre>
<p>Next, we want to split each part with <code>;</code> to get the <code>link</code> and <code>rel</code> for each part.</p>
<figure>
  <img src="../../images/ajax/paginated/link-header-parts.gif" alt="GIF that shows that each part of the link header has two more parts—link and rel.">
  <figcaption aria-hidden>Each part of the link header has two more parts—link and rel.</figcaption>
</figure>
<p>Here’s how splitting the first part would look like:</p>
<pre><code class="language-js">const firstPart = parts[0]
const [link, rel] = firstPart.split(';')

console.log(link) // '&lt;https://api.github.com/user/170270/repos?per_page=100&amp;page=2&gt;'
console.log(rel) // ' rel=&quot;next&quot;'
</code></pre>
<p>Next, we want to format <code>link</code> and <code>rel</code> so we get an object that uses <code>rel</code> as a property and <code>link</code> as the value, like this:</p>
<pre><code class="language-js">const parsedLinkHeader = {
  next: 'a link',
  last: 'another link'
}
</code></pre>
<p>We can do this with the <code>replace</code> method.</p>
<h3 id="replace">Replace</h3>
<p><code>replace</code> lets you replace parts of a string with other characters.</p>
<pre><code class="language-js">const replaced = string.replace(partToBeReplaced, replacer)
</code></pre>
<p><code>partToBeReplaced</code> is the character(s) you want to replace.</p>
<p><code>replacer</code> is the characters you want to replace with.</p>
<p>Here’s an example:</p>
<pre><code class="language-js">const string = 'My name is Zell'
const replaced = string.replace('Zell', 'Vincy')

console.log(replaced) // My name is Vincy
</code></pre>
<h3 id="formatting-the-first-part">Formatting the first part</h3>
<p>We’ll use an empty string as the replacer to remove the angled brackets. After we remove the angled brackets, we also want to use <code>trim</code> to remove any leading and trailing spaces.</p>
<pre><code class="language-js">const removedLeftBracket = link.replace('&lt;', '')
const removedRightBracket = removedLeftBracket.replace('&gt;', '')
const trimmed = removedRightBracket.trim()
</code></pre>
<p>These three steps can be combined into one.</p>
<pre><code class="language-js">const formattedLink = link.replace('&lt;', '').replace('&gt;', '').trim()

console.log(formattedLink) // 'https://api.github.com/user/170270/repos?per_page=100&amp;page=2'
</code></pre>
<p>We want to format <code>rel</code> as well.</p>
<pre><code class="language-js">const formattedRel = rel.replace('rel=&quot;', '').replace('&quot;', '').trim()

console.log(formattedRel) // 'next'
</code></pre>
<p>Once we’ve formatted <code>link</code> and <code>rel</code>, we can create an object that gives us information about the next link.</p>
<pre><code class="language-js">const parsedFirstPart = {
  [formattedRel]: formattedLink
}

console.log(parsedFirstPart.next)
// { next: 'https://api.github.com/user/170270/repos?per_page=100&amp;page=2' }
</code></pre>
<h3 id="parse-and-format-the-second-part">Parse and format the second part</h3>
<p>The process to parse and format the second part is the same as the process to parse and format the first part. I’ve created a function for you to speed things up.</p>
<pre><code class="language-js">const parseLinkHeader = linkHeader =&gt; {
  const parts = linkHeader.split(',')
  return parts.reduce((acc, part) =&gt; {
    const [l, r] = part.split(';')
    const link = l.replace('&lt;', '').replace('&gt;', '').trim()
    const rel = r.replace('rel=&quot;', '').replace('&quot;', '').trim()
    return Object.assign({}, acc, { [rel]: link })
  }, {})
}

// Usage
const parsedLink = parseLinkHeader(linkHeader)
</code></pre>
<h2 id="getting-the-last-page">Getting the last page</h2>
<p>Your parsed link header should look like this:</p>
<pre><code class="language-js">const parsedLinkHeader = {
  'last': 'some-url?per_page=100&amp;page=10',
  'next': 'some-url?per_page=100&amp;page=2'
}
</code></pre>
<p>We need to parse <code>some-url?per_page&amp;page=10</code> to get the final page. We can do this with <code>URLSearchParams</code>.</p>
<h3 id="urlsearchparams">URLSearchParams</h3>
<p><code>URLSearchParams</code> help us extract parameters from query strings. To use it, you provide the query string you want to parse to <code>new URLSearchParams</code>.</p>
<pre><code class="language-js">const searchParams = new URLSearchParams('per_page=100&amp;page=5')
</code></pre>
<p>You can search for the parameter you want with the <code>get</code> method.</p>
<pre><code class="language-js">const page = searchParams.get('page')
console.log(page) // 5
</code></pre>
<h3 id="getting-the-last-page-with-urlsearchparams">Getting the last page with URLSearchParams</h3>
<p>We need to pass the query string into <code>URLSearchParams</code>. To get the query string, we can split the link at <code>?</code>.</p>
<pre><code class="language-js">const queryString = parsedLinkHeader.last.split('?')[1]
</code></pre>
<p>We can get the last page with the following code:</p>
<pre><code class="language-js">const searchParams = new URLSearchParams(queryString)
const lastPage = searchParams.get('page')

console.log(lastPage) // 10
</code></pre>
<h2 id="fetching-many-pages-at-once-2">Fetching many pages at once</h2>
<p>We need to use <code>Promise.all</code> to fetch many requests at once. Since we know the last page is ten, we need to construct a <code>Promise.all</code> that looks like this:</p>
<pre><code class="language-js">Promise.all([
  fetch('Page 2'),
  fetch('Page 3'),
  fetch('Page 4'),
  fetch('Page 5'),
  fetch('Page 6'),
  fetch('Page 7'),
  fetch('Page 8'),
  fetch('Page 9'),
  fetch('Page 10')
])
</code></pre>
<p>We can use a <code>for</code> loop to create this array or promises. This for loop can start with <code>index</code> 2 (for page 2) and end at <code>index</code> 10 (for page 10).</p>
<pre><code class="language-js">const link = 'https://api.github.com/users/sindresorhus/repos?per_page=100'

let array = []
for (let index = 2; index &lt;= lastPage; index++) {
  const request = fetch(`${link}&amp;page=${index}`)
    .then(r =&gt; r.json())

  array = array.concat(request)
}

Promise.all(array)
  .then(results =&gt; { /* Do something with results*/ })
</code></pre>
<p>Note: you’ll hit your rate limit quickly when you request for many pages at once. You might want to authenticate yourself so you have a larger limit.</p>
<h3 id="flattening-promise.all-results">Flattening Promise.all results</h3>
<p><code>Promise.all</code> returns an array with results from each promise.</p>
<pre><code class="language-js">Promise.all(array)
  .then(results =&gt; console.log(results))
</code></pre>
<figure>
  <img src="../../images/ajax/paginated/array-of-arrays.png" alt="Promise.all returns an array of responses. Each response is an array">
  <figcaption aria-hidden>Promise.all returns an array of responses. Each response is an array</figcaption>
</figure>
<p>We don’t want an array of arrays. We don’t care about the pages. We want one array that contains all repositories.</p>
<pre><code class="language-js">// What we want
const repos = [
  repo1,
  repo2,
  repo3,
  ...,
  lastRepo
]
</code></pre>
<p>We can use <code>reduce</code> to flatten the array of arrays into a single array. We covered how to do this in the lesson on reduce.</p>
<pre><code class="language-js">Promise.all(requests)
  .then(responses =&gt; {
    const flattened = responses.reduce(
      (acc, repos) =&gt; [...acc, ...repos]
    , [])
  })
</code></pre>
<p>This gives us an array of repositories from Page 2 to the last page. We can include repositories from the first page if we set the first page as the initial value.</p>
<pre><code class="language-js">const page1 = response.body
Promise.all(requests)
  .then(responses =&gt; {
    const flattened = responses.reduce(
      (acc, repos) =&gt; [...acc, ...repos], page1
    )
  })
</code></pre>
<p>You can return the value from <code>Promise.all</code> to work and work on the repos in the next <code>then</code> call.</p>
<pre><code class="language-js">.then(response =&gt; {
  const page1 = response.body
  return Promise.all(requests)
    .then(responses =&gt; {
      return responses.reduce(
        (acc, repos) =&gt; [...acc, ...repos], page1
      )
    })
})
.then(repos =&gt; {
  console.log(repos)
})
</code></pre>
<figure>
  <img src="../../images/ajax/paginated/array-of-repos.png" alt="We can flatten the responses to get an array of repositories">
  <figcaption>We can flatten the responses to get an array of repositories</figcaption>
</figure>
<h2 id="the-code">The code</h2>
<p>Here’s the code to execute everything we talked about.</p>
<pre><code class="language-js">const link = 'https://api.github.com/users/sindresorhus/repos?per_page=100'
fetch(link)
  // Pass headers and body into the next then call
  .then(r =&gt; {
    const headers = Array.from(r.headers.entries())
      .reduce((accumulator, [header, value]) =&gt; {
        return Object.assign(accumulator, {
          [header]: value
        })
      }, {})

    return r.json()
      .then(body =&gt; ({ headers, body }))
  })
  .then(res =&gt; {
    // Parse link headers
    const parsed = parseLinkHeader(res.headers.link)

    // Gets last page
    const queryString = parsed.last.split('?')[1]
    const searchParams = new URLSearchParams(queryString)
    const lastPage = searchParams.get('page')

    // Make array of promises
    let promises = []
    for (let index = 2; index &lt;= lastPage; index++) {
      const request = fetch(`${link}&amp;page=${index}`)
        .then(r =&gt; r.json())
      promises = promises.concat(request)
    }

    // Fetches all pages and flattens the results
    return Promise.all(promises)
      .then(results =&gt; {
        return results.reduce(
          (acc, result) =&gt; [...acc, ...result], res.body
        )
      })
  })
  .then(repos =&gt; {
    console.log(repos)
  })
</code></pre>
<h2 id="an-alternate-way-to-make-the-array-of-promises">An alternate way to make the array of promises</h2>
<p>We can make the array of promises with <code>Array.from</code>. To do so, we pass an object with a <code>length</code> property. <code>Array.from</code> will treat this object as an array-like object. It will create array items and fill them with <code>undefined</code>.</p>
<pre><code class="language-js">const promises = Array.from({length: lastPage - 1})

console.log(promises.length) // 9
console.log(promises) // [undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined,]
</code></pre>
<p>You can use <code>map</code> to create the array of fetch requests. Use the <code>index</code> value to fetch the correct page.</p>
<pre><code class="language-js">const promises = Array.from({length: lastPage - 1})
  .map((value, index) =&gt; {
    return fetch(`https://api.github.com/users/sindresorhus/repos?per_page=100&amp;page=${index + 2}`)
      .then(r =&gt; r.json())
  })
</code></pre>
<h2 id="exercise">Exercise</h2>
<ol>
<li>Fetch all repositories by Sindre with fetch</li>
<li>Fetch all repositories by Sindre with zlFetch</li>
</ol>
</article>
  </div>



  <div class="longform">
    <nav class="lesson-nav">
      </nav>
  </div>
</div>
    </main>



      <script module src="../../js/main-b9439821d7.mjs"></script>
      <script nomodule src="../../js/main-legacy-8c54230a8f.js"></script>
  </body>

<!-- /paginated-responses-1/  Mon, 24 Jan 2022 10:08:18 GMT -->
</html>
